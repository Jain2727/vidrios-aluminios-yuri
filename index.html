<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sistema de Cotizaciones - Yuri</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">

<style>

body{
    font-family:'Montserrat',sans-serif;
    background:#eef3f9;
    margin:0;
    padding:20px;
    color:#1b2b48;
}

h1{
    font-family:'Playfair Display',serif;
    font-size:32px;
    letter-spacing:2px;
    color:#0d2d5c;
    margin-bottom:30px;
}

.panel{
    background:white;
    padding:25px;
    border-radius:12px;
    box-shadow:0 10px 30px rgba(0,0,0,0.08);
    margin-bottom:30px;
}

input,textarea{
    width:100%;
    padding:10px;
    border-radius:8px;
    border:1px solid #cbd6e2;
    margin-bottom:15px;
    font-size:14px;
}

button{
    background:#0d47a1;
    color:white;
    padding:10px 18px;
    border:none;
    border-radius:8px;
    font-weight:600;
    cursor:pointer;
    margin:5px;
}

button:hover{
    background:#08306b;
}

table{
    width:100%;
    border-collapse:collapse;
    margin-top:15px;
}

th{
    background:#0d47a1;
    color:white;
    padding:12px;
    font-size:14px;
}

td{
    border:1px solid #d9e2ef;
    padding:10px;
    font-size:14px;
}

tfoot td{
    font-weight:bold;
}

.a4{
    width:210mm;
    min-height:297mm;
    background:white;
    padding:40px;
    margin:auto;
    box-shadow:0 10px 30px rgba(0,0,0,0.15);
    position:relative;
}

.header{
    display:flex;
    justify-content:space-between;
    margin-bottom:30px;
}

.empresa h2{
    margin:0;
    font-family:'Playfair Display',serif;
    font-size:22px;
}

.empresa p{
    margin:3px 0;
    font-size:13px;
}

.titulo{
    text-align:right;
}

.titulo h2{
    margin:0;
    font-size:20px;
}

.cliente{
    margin-bottom:20px;
    font-size:14px;
}

.totales{
    width:300px;
    margin-left:auto;
    margin-top:20px;
}

.firma{
    margin-top:60px;
}

.firma img{
    height:80px;
}

.footer{
    position:absolute;
    bottom:0;
    left:0;
    width:100%;
    background:#0d47a1;
    color:white;
    padding:12px 40px;
    font-size:13px;
}

</style>
</head>

<body>

<h1>VIDRIOS Y ALUMINIOS YURI</h1>

<div class="panel">

<h3>Datos Cliente</h3>
<input id="clienteNombre" placeholder="Nombre cliente">
<input id="clienteRuc" placeholder="DNI / RUC">
<input id="clienteDireccion" placeholder="Dirección">

<h3>Agregar Ítem</h3>
<input id="descripcion" placeholder="Descripción">
<input id="cantidad" type="number" value="1">
<input id="precio" type="number" value="0">

<button onclick="agregar()">Agregar</button>

<table id="tabla">
<thead>
<tr>
<th>Item</th>
<th>Descripción</th>
<th>Cant.</th>
<th>Precio</th>
<th>Subtotal</th>
</tr>
</thead>
<tbody></tbody>
</table>

<button onclick="generarHoja()">Generar Vista Profesional</button>
<button onclick="descargarPDF()">Descargar PDF Profesional</button>

</div>

<div id="hoja" style="display:none;"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>

let items=[];

function agregar(){
    let desc=document.getElementById("descripcion").value;
    let cant=parseFloat(document.getElementById("cantidad").value);
    let precio=parseFloat(document.getElementById("precio").value);
    let subtotal=cant*precio;
    items.push({desc,cant,precio,subtotal});
    render();
}

function render(){
    let tbody=document.querySelector("#tabla tbody");
    tbody.innerHTML="";
    items.forEach((i,index)=>{
        tbody.innerHTML+=`
        <tr>
        <td>${index+1}</td>
        <td>${i.desc}</td>
        <td>${i.cant}</td>
        <td>S/ ${i.precio.toFixed(2)}</td>
        <td>S/ ${i.subtotal.toFixed(2)}</td>
        </tr>
        `;
    });
}

function generarHoja(){

    let subtotal=items.reduce((a,b)=>a+b.subtotal,0);
    let igv=subtotal*0.18;
    let total=subtotal+igv;

    let html=`
    <div class="a4">
    <div class="header">
        <div class="empresa">
            <h2>VIDRIOS Y ALUMINIOS YURI</h2>
            <p>RUC: 10617365036</p>
            <p>CC.HACCA S/N OMACHA - PARURO - CUSCO</p>
        </div>
        <div class="titulo">
            <h2>COTIZACIÓN</h2>
            <p>${new Date().toLocaleDateString()}</p>
        </div>
    </div>

    <div class="cliente">
        <strong>Cliente:</strong> ${document.getElementById("clienteNombre").value}<br>
        <strong>RUC/DNI:</strong> ${document.getElementById("clienteRuc").value}<br>
        <strong>Dirección:</strong> ${document.getElementById("clienteDireccion").value}
    </div>

    <table>
    <thead>
    <tr>
    <th>Item</th>
    <th>Descripción</th>
    <th>Cantidad</th>
    <th>Precio Unit.</th>
    <th>Subtotal</th>
    </tr>
    </thead>
    <tbody>
    ${items.map((i,index)=>`
        <tr>
        <td>${index+1}</td>
        <td>${i.desc}</td>
        <td>${i.cant}</td>
        <td>S/ ${i.precio.toFixed(2)}</td>
        <td>S/ ${i.subtotal.toFixed(2)}</td>
        </tr>`).join("")}
    </tbody>
    </table>

    <div class="totales">
        <p>Subtotal: S/ ${subtotal.toFixed(2)}</p>
        <p>IGV (18%): S/ ${igv.toFixed(2)}</p>
        <h3>Total: S/ ${total.toFixed(2)}</h3>
    </div>

    <div class="firma">
        <p>Firma:</p>
        <img src="firma.png">
    </div>

    <div class="footer">
    CC.HACCA S/N OMACHA - PARURO - CUSCO |
    Correo: hermozayurihermozapuelles@gmail.com |
    Cel: 993 963 381
    </div>

    </div>
    `;

    let hoja=document.getElementById("hoja");
    hoja.innerHTML=html;
    hoja.style.display="block";
}

async function descargarPDF(){
    generarHoja();
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF("p","mm","a4");
    const canvas = await html2canvas(document.querySelector(".a4"),{scale:2});
    const imgData = canvas.toDataURL("image/png");
    doc.addImage(imgData,"PNG",0,0,210,297);
    doc.save("Cotizacion_Yuri.pdf");
}

</script>

</body>
</html>
